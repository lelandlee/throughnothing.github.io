<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Java 8 Coding Guide - willwolf.com</title>
        <link rel="stylesheet" href="../all.css" />
    </head>
    <body>

        <div class="sidebar">
            <a href="../" class="face-logo">
            </a>

            <div class="side-nav">
                <!-- <a href="/">About</a> -->
                <a href="../writing.html">Writing</a>
                <!--<a href="/projects.html">Projects</a>-->
                <a href="../reading.html">Reading</a>
                <!--<a href="/archive.html">Archive</a>-->
            </div>

            <div class="side-footer">
                <a class="twitter" target="_social" href="https://twitter.com/throughnothing">
                    <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path d="M16 3.038c-.59.26-1.22.437-1.885.517.677-.407 1.198-1.05 1.443-1.816-.634.37-1.337.64-2.085.79-.598-.64-1.45-1.04-2.396-1.04-1.812 0-3.282 1.47-3.282 3.28 0 .26.03.51.085.75-2.728-.13-5.147-1.44-6.766-3.42C.83 2.58.67 3.14.67 3.75c0 1.14.58 2.143 1.46 2.732-.538-.017-1.045-.165-1.487-.41v.04c0 1.59 1.13 2.918 2.633 3.22-.276.074-.566.114-.865.114-.21 0-.41-.02-.61-.058.42 1.304 1.63 2.253 3.07 2.28-1.12.88-2.54 1.404-4.07 1.404-.26 0-.52-.015-.78-.045 1.46.93 3.18 1.474 5.04 1.474 6.04 0 9.34-5 9.34-9.33 0-.14 0-.28-.01-.42.64-.46 1.2-1.04 1.64-1.7z" fill-rule="nonzero"></path></svg>
                </a>
                <a class="github" target="_social" href="https://github.com/throughnothing">
                    <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path d="M8 0C3.58 0 0 3.582 0 8c0 3.535 2.292 6.533 5.47 7.59.4.075.547-.172.547-.385 0-.19-.007-.693-.01-1.36-2.226.483-2.695-1.073-2.695-1.073-.364-.924-.89-1.17-.89-1.17-.725-.496.056-.486.056-.486.803.056 1.225.824 1.225.824.714 1.223 1.873.87 2.33.665.072-.517.278-.87.507-1.07-1.777-.2-3.644-.888-3.644-3.953 0-.873.31-1.587.823-2.147-.09-.202-.36-1.015.07-2.117 0 0 .67-.215 2.2.82.64-.178 1.32-.266 2-.27.68.004 1.36.092 2 .27 1.52-1.035 2.19-.82 2.19-.82.43 1.102.16 1.915.08 2.117.51.56.82 1.274.82 2.147 0 3.073-1.87 3.75-3.65 3.947.28.24.54.73.54 1.48 0 1.07-.01 1.93-.01 2.19 0 .21.14.46.55.38C13.71 14.53 16 11.53 16 8c0-4.418-3.582-8-8-8"></path></svg>
                </a>
                <a class="linkedin" target="_social" href="https://www.linkedin.com/in/throughnothing/">
                    <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path d="M13.632 13.635h-2.37V9.922c0-.886-.018-2.025-1.234-2.025-1.235 0-1.424.964-1.424 1.96v3.778h-2.37V6H8.51v1.04h.03c.318-.6 1.092-1.233 2.247-1.233 2.4 0 2.845 1.58 2.845 3.637v4.188zM3.558 4.955c-.762 0-1.376-.617-1.376-1.377 0-.758.614-1.375 1.376-1.375.76 0 1.376.617 1.376 1.375 0 .76-.617 1.377-1.376 1.377zm1.188 8.68H2.37V6h2.376v7.635zM14.816 0H1.18C.528 0 0 .516 0 1.153v13.694C0 15.484.528 16 1.18 16h13.635c.652 0 1.185-.516 1.185-1.153V1.153C16 .516 15.467 0 14.815 0z" fill-rule="nonzero"></path></svg>
                </a>
                <!-- <a class="goodreads" target="_social" href="https://www.goodreads.com/user/show/7295031-will">
                    <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path d="M13.022 10.63V.326h-1.37V2.26h-.043c-.14-.303-.32-.593-.56-.87-.24-.274-.51-.517-.82-.727-.31-.21-.64-.373-1.01-.49C8.85.06 8.46 0 8.04 0c-.805 0-1.53.15-2.16.446-.63.297-1.16.703-1.587 1.217-.427.515-.753 1.116-.978 1.804-.224.69-.337 1.417-.337 2.185 0 .797.094 1.547.283 2.25.19.703.49 1.315.91 1.837.42.52.94.93 1.58 1.22.64.29 1.41.44 2.31.44.83 0 1.55-.21 2.17-.63.62-.42 1.09-.98 1.41-1.68h.04v1.52c0 1.36-.28 2.4-.84 3.13-.56.72-1.48 1.09-2.76 1.09-.38 0-.75-.04-1.11-.12-.36-.08-.69-.21-.99-.38-.29-.18-.55-.4-.76-.69-.21-.29-.35-.64-.42-1.06H3.4c.045.59.21 1.1.49 1.53.283.43.64.78 1.066 1.06.427.27.91.47 1.445.6.54.13 1.09.2 1.66.2.92 0 1.69-.13 2.32-.37.63-.25 1.14-.6 1.53-1.07.4-.47.68-1.03.86-1.7.18-.67.28-1.42.28-2.24zm-4.98-.37c-.636 0-1.187-.126-1.65-.38-.464-.253-.85-.587-1.153-1-.31-.413-.53-.887-.68-1.423-.15-.537-.22-1.087-.22-1.653 0-.58.07-1.148.2-1.706.14-.558.36-1.055.66-1.49.3-.434.69-.786 1.15-1.054.46-.268 1.02-.402 1.67-.402s1.2.138 1.66.413c.45.276.83.638 1.12 1.087.29.45.5.95.63 1.5s.19 1.102.19 1.652c0 .566-.08 1.116-.23 1.653-.15.536-.38 1.01-.69 1.423-.31.413-.68.747-1.13 1-.45.254-.97.38-1.57.38z" fill-rule="nonzero"/></svg>
                </a> -->
                <a class="rss" target="_rss" href="../rss.xml">
                    <svg aria-labelledby="simpleicons-rss-icon" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title id="simpleicons-rss-icon">RSS icon</title><path d="M19.199 24C19.199 13.467 10.533 4.8 0 4.8V0c13.165 0 24 10.835 24 24h-4.801zM3.291 17.415c1.814 0 3.293 1.479 3.293 3.295 0 1.813-1.485 3.29-3.301 3.29C1.47 24 0 22.526 0 20.71s1.475-3.294 3.291-3.295zM15.909 24h-4.665c0-6.169-5.075-11.245-11.244-11.245V8.09c8.727 0 15.909 7.184 15.909 15.91z"></path></svg>
                </a>
            </div>

            <div class="copyright"><a href="http://copyheart.org">❤</a> William Wolf  |  <a target="_source" href="https://github.com/throughnothing/throughnothing.github.io/">Source</a></div>
        </div>

        <div class="content">
            
<div class="post">

  <h1>Java 8 Coding Guide</h1>
  <span class="post-date">08 Nov 2017</span>
  <hr />

  <p>I’m getting into Java services at work, and I put together a guide with some principles / best practices to follow for Java 8.  A lot of these things become much more possible with Java 8 than they would have been in earlier versions of Java, but they can also be applied to other programming languages and technologies.</p>
<p>I wrote this guide based on a desire to have code that is easy to reason about and understand, which means it will be easy for new folks to jump into the codebase over time, and also with a desire to quickly produce high quality code.  Performance is not the major concern of this guide.</p>
<p>Many of the principles and ideas come from my foray into functional programming with both <a href="https://www.haskell.org">Haskell</a> and <a href="http://www.purescript.org">Purescript</a>, and I just find that these concepts are the way I prefer to program now.  Following these principles gives me much more confidence in the correctness of my code, and gives me peace of mind knowing that I’m giving myself the best chance of understanding the code when I come back to it months or years later.</p>
<p>Without further ado, you can check out the guide <a href="https://gist.github.com/throughnothing/4a14dd3e4ab5e68eb154123ad11dae79">here</a> (inlined below).</p>
<p></p>
<hr />
<p></p>
<h1 id="java-8-coding-guide">Java 8 Coding Guide</h1>
<p>This coding guide was written for a Java 8 project, but contains principles that are valid in many languages. It is aimed at producing code that is easy to reason about, easy to validate and test, easy to maintain, and easy to avoid common bugs and pitfalls.</p>
<h2 id="avoid-explicit-null-or-dont-use-null">Avoid explicit <code>null</code> (or, Don’t use <code>null</code>)</h2>
<p><code>Null</code> is famously the <a href="https://www.lucidchart.com/techblog/2015/08/31/the-worst-mistake-of-computer-science/">“billion dollar mistake”</a> (and that’s probably an under-estimation!). Don’t use <code>null</code> as a way of representing error or failure, and also don’t use <code>null</code> as a way to avoid passing a certain argument to a function. Essentially you should never explicitly use a <code>null</code> value unless you are checking that something is not <code>null</code>. Even in those cases, it should probably be handled better by an <code>Option&lt;T&gt;</code>.</p>
<h3 id="resources">Resources</h3>
<ul>
<li><a href="https://github.com/google/guava/wiki/UsingAndAvoidingNullExplained" class="uri">https://github.com/google/guava/wiki/UsingAndAvoidingNullExplained</a></li>
<li><a href="http://www.oracle.com/technetwork/articles/java/java8-optional-2175753.html" class="uri">http://www.oracle.com/technetwork/articles/java/java8-optional-2175753.html</a></li>
<li><a href="https://www.infoq.com/presentations/Null-References-The-Billion-Dollar-Mistake-Tony-Hoare" class="uri">https://www.infoq.com/presentations/Null-References-The-Billion-Dollar-Mistake-Tony-Hoare</a></li>
</ul>
<h2 id="expressions-over-statements">Expressions over statements</h2>
<p>Expressions are declarative and evaluate to (and return) a value, while statements are imperative bits of code that perform actions. Because of this, expressions are easier to reason about, debug, and verify correctness for.</p>
<p>A simple example is an <code>if</code> statement, vs an <code>if</code> expression. <code>If</code> in java does not return a value, nor does java enforce that an <code>if</code> have an <code>else</code> branch. Additionally, if there is an <code>else</code> branch, it does not have to result in the same type of value as the <code>if</code> branch. This makes if statements hard to reason about and understand. The ternary form <code>predicate ? value : value</code> is preferable to <code>if</code>/<code>then</code> statements.</p>
<p>In a language like Java, statements will be required, but we should isolate those to their own, small, methods, and keep their surface area as small as possible to reduce risk and complexity from these parts of the code.</p>
<h3 id="resources-1">Resources</h3>
<ul>
<li><a href="https://fsharpforfunandprofit.com/posts/expressions-vs-statements/" class="uri">https://fsharpforfunandprofit.com/posts/expressions-vs-statements/</a></li>
<li><a href="https://www.cs.ucf.edu/~dcm/Teaching/COT4810-Fall%202012/Literature/Backus.pdf">https://www.cs.ucf.edu/~dcm/Teaching/COT4810-Fall%202012/Literature/Backus.pdf</a></li>
</ul>
<h2 id="avoid-explicit-loops">Avoid explicit loops</h2>
<p>With Java 8, we have streams, and should no longer need explicit loops. Loops are very repetetive, and error prone, so we should leverage abstractions that handle looping for us to avoid bugs, verbosity, and complexity in our code.</p>
<p>There may be some cases where loops are more desirable (possibly for performance), but they should be avoided until it is clear they are actually needed.</p>
<h3 id="resources-2">Resources</h3>
<ul>
<li><a href="http://www.deadcoderising.com/java-8-no-more-loops/" class="uri">http://www.deadcoderising.com/java-8-no-more-loops/</a></li>
<li><a href="https://martinfowler.com/articles/refactoring-pipelines.html" class="uri">https://martinfowler.com/articles/refactoring-pipelines.html</a></li>
</ul>
<h2 id="use-immutable-data-structures">Use immutable data structures</h2>
<p>We should leverage <code>guava</code>’s immutable data structures as much as possible to avoid complicated bugs related to mutating state.</p>
<p>Additionally, we should leverage Lombok’s <code>@Value</code> objects as much as possible to make our own data objects immutable.</p>
<h3 id="resources-3">Resources</h3>
<ul>
<li><a href="https://github.com/google/guava/wiki/ImmutableCollectionsExplained" class="uri">https://github.com/google/guava/wiki/ImmutableCollectionsExplained</a></li>
<li><a href="https://projectlombok.org/features/Value" class="uri">https://projectlombok.org/features/Value</a></li>
</ul>
<h2 id="dont-throw-exceptions---use-values">Don’t throw exceptions - use values!</h2>
<p>In general, we should never throw an exception of our own. Obviously we will use libraries that throw exceptions. These exceptions should be caught directly in the function/method using the library, and turned into values (to be returned) as much as possible.</p>
<p>This is because exceptions are like <code>goto</code> statements, which make the flow of your program much more difficult to reason about. Every function that throws an exception can return a value in 2 ways, through the “normal” return flow, or through an exception, and every user of that function has to think about both cases. It is generally easier to reason about functions that only return values (something like vavr’s <a href="http://www.baeldung.com/vavr-either">Either</a> or <a href="http://www.baeldung.com/vavr-try">Try</a> types work very well for this). This also makes it much easier to leverage Java 8’s lambda-using utilities, as they don’t like accepting <code>Function</code>s that throw exceptions.</p>
<h3 id="resources-4">Resources</h3>
<ul>
<li><a href="https://www.joelonsoftware.com/2003/10/13/13/" class="uri">https://www.joelonsoftware.com/2003/10/13/13/</a></li>
<li><a href="http://www.baeldung.com/vavr-try" class="uri">http://www.baeldung.com/vavr-try</a></li>
<li><a href="http://www.baeldung.com/vavr-either" class="uri">http://www.baeldung.com/vavr-either</a></li>
<li><a href="https://fsharpforfunandprofit.com/rop/" class="uri">https://fsharpforfunandprofit.com/rop/</a></li>
</ul>
<h2 id="fail-early-enforce-invariants">Fail early, enforce invariants</h2>
<p>It is always best to fail as early as possible, at the soonest point that you find something is wrong. This often means that we should validate all of our data up front, to decouple validation from the business logic that needs to use the values in question.</p>
<p>Additionally, the more we can make fail at compile time, rather than run time, the better off we will be at finding bugs earlie. Use Java’s typesystem as much as you can to enforce invariants statically!</p>
<p>For our own data objects, we should have strong validation of each object, so that once we’ve constructed one, we know it will have good data in the rest of our program. Failed construction (on validation errors) should also be expressed by returning values, rather than exceptions. Something like vavr’s <a href>Validation</a> type is useful for this purpose. Make it impossible to construct a “bad”/invalid data object!</p>
<h3 id="resources-5">Resources</h3>
<ul>
<li><a href="https://www.leepoint.net/principles_and_practices/40fail-early-fail-often.html" class="uri">https://www.leepoint.net/principles_and_practices/40fail-early-fail-often.html</a></li>
<li><a href="https://softwaremill.com/javaslang-data-validation/" class="uri">https://softwaremill.com/javaslang-data-validation/</a></li>
</ul>
<h2 id="composition-over-inheritance">Composition over Inheritance</h2>
<p>Inheritance can be very fragile, and make refactoring of complex code involving inheritance hierarchies very difficult to do safely and confidently. Composition (and in java, Interfaces) should be favored over inheritence where possible.</p>
<p>Often inheritance is required by certain frameworks / libraries, but we should limit the depth of inheritance hierarchies that we use as much as possible.</p>
<p>Composition, via composing interfaces or composable types, allows for more design flexibility, and easier, more confident refactoring.</p>
<h3 id="resources-6">Resources</h3>
<ul>
<li><a href="https://www.thoughtworks.com/insights/blog/composition-vs-inheritance-how-choose" class="uri">https://www.thoughtworks.com/insights/blog/composition-vs-inheritance-how-choose</a></li>
<li><a href="https://en.wikipedia.org/wiki/Composition_over_inheritance" class="uri">https://en.wikipedia.org/wiki/Composition_over_inheritance</a></li>
<li><a href="https://variadic.me/posts/2014-03-28-composition-over-inheritance.html" class="uri">https://variadic.me/posts/2014-03-28-composition-over-inheritance.html</a></li>
</ul>

</div>

        </div>

        
    </body>
</html>